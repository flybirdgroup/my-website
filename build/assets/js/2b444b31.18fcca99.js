"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5508],{3905:(e,t,a)=>{a.d(t,{Zo:()=>i,kt:()=>g});var o=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,o,r=function(e,t){if(null==e)return{};var a,o,r={},n=Object.keys(e);for(o=0;o<n.length;o++)a=n[o],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)a=n[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=o.createContext({}),c=function(e){var t=o.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},i=function(e){var t=c(e.components);return o.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var a=e.components,r=e.mdxType,n=e.originalType,p=e.parentName,i=s(e,["components","mdxType","originalType","parentName"]),u=c(a),g=r,m=u["".concat(p,".").concat(g)]||u[g]||d[g]||n;return a?o.createElement(m,l(l({ref:t},i),{},{components:a})):o.createElement(m,l({ref:t},i))}));function g(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var n=a.length,l=new Array(n);l[0]=u;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:r,l[1]=s;for(var c=2;c<n;c++)l[c]=a[c];return o.createElement.apply(null,l)}return o.createElement.apply(null,a)}u.displayName="MDXCreateElement"},58098:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>d,frontMatter:()=>n,metadata:()=>s,toc:()=>c});var o=a(87462),r=(a(67294),a(3905));const n={id:"Airflow1",title:"\u901a\u8fc7Composer\u4f7f\u7528Airflow\u8fd0\u884c\u4e00\u4e2aworkflow",author:"\u62db\u6653\u8d24",author_title:"AI engine @ Facebook",author_url:"https://github.com/flybirdgroup",tags:["facebook","hello","docusaurus","google cloud","linux"]},l="\u6574\u4e2a\u6d41\u7a0b\u662f",s={permalink:"/blog/2020/6/12/Airflow_Dataproc",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2020-6-12-Airflow_Dataproc.md",source:"@site/blog/2020-6-12-Airflow_Dataproc.md",title:"\u901a\u8fc7Composer\u4f7f\u7528Airflow\u8fd0\u884c\u4e00\u4e2aworkflow",description:"\u521b\u5efaComposer by setting up Composer environment >> create a workflow py file >>  \u521b\u5efaDataproc >> Runs Hadoop job on Dataproc >> deletes Dataproc cluster",date:"2020-06-12T00:00:00.000Z",formattedDate:"June 12, 2020",tags:[{label:"facebook",permalink:"/blog/tags/facebook"},{label:"hello",permalink:"/blog/tags/hello"},{label:"docusaurus",permalink:"/blog/tags/docusaurus"},{label:"google cloud",permalink:"/blog/tags/google-cloud"},{label:"linux",permalink:"/blog/tags/linux"}],readingTime:6.2,hasTruncateMarker:!1,authors:[{name:"\u62db\u6653\u8d24",title:"AI engine @ Facebook",url:"https://github.com/flybirdgroup"}],frontMatter:{id:"Airflow1",title:"\u901a\u8fc7Composer\u4f7f\u7528Airflow\u8fd0\u884c\u4e00\u4e2aworkflow",author:"\u62db\u6653\u8d24",author_title:"AI engine @ Facebook",author_url:"https://github.com/flybirdgroup",tags:["facebook","hello","docusaurus","google cloud","linux"]},prevItem:{title:"MDX Blog Post",permalink:"/blog/mdx-blog-post"},nextItem:{title:"\u4e91\u4e0a\u5feb\u901f\u642d\u5efaWordPress\u7f51\u7ad9",permalink:"/blog/2020/6/12/\u5feb\u901f\u642d\u5efawordpress\u7f51\u7ad9"}},p={authorsImageUrls:[void 0]},c=[{value:"step1 Create Enviroment and set up the Enviroment",id:"step1-create-enviroment-and-set-up-the-enviroment",level:2},{value:"step2 \u521b\u5efaGCS bucket",id:"step2-\u521b\u5efagcs-bucket",level:2},{value:"step3 \u4e86\u89e3\u6838\u5fc3\u6982\u5ff5",id:"step3-\u4e86\u89e3\u6838\u5fc3\u6982\u5ff5",level:2},{value:"step4: \u8bbe\u5b9a\u4e00\u4e2aworkflow \u5de5\u4f5c\u6d41",id:"step4-\u8bbe\u5b9a\u4e00\u4e2aworkflow-\u5de5\u4f5c\u6d41",level:2},{value:"\u4e3a\u4e86\u534f\u8c03\u8fd9\u4e09\u4e2a\u5de5\u4f5c\u6d41\u7a0b\u4efb\u52a1\uff0cDAG\u5bfc\u5165\u4e86\u4ee5\u4e0b\u8fd0\u7b97\u7b26\uff1a",id:"\u4e3a\u4e86\u534f\u8c03\u8fd9\u4e09\u4e2a\u5de5\u4f5c\u6d41\u7a0b\u4efb\u52a1dag\u5bfc\u5165\u4e86\u4ee5\u4e0b\u8fd0\u7b97\u7b26",level:2},{value:"step5 \u8bbe\u7f6eairflow\u53d8\u91cf",id:"step5-\u8bbe\u7f6eairflow\u53d8\u91cf",level:2},{value:"step6 \u5c06DAG\u4e0a\u8f7d\u5230\u4e91\u5b58\u50a8",id:"step6-\u5c06dag\u4e0a\u8f7d\u5230\u4e91\u5b58\u50a8",level:2},{value:"step7 \u91cd\u65b0\u8fd0\u884c\u5de5\u4f5c\u6d41\u7a0b",id:"step7-\u91cd\u65b0\u8fd0\u884c\u5de5\u4f5c\u6d41\u7a0b",level:2}],i={toc:c};function d(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,o.Z)({},i,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"\u521b\u5efaComposer by setting up Composer environment >> create a workflow py file >>  \u521b\u5efaDataproc >> Runs Hadoop job on Dataproc >> deletes Dataproc cluster"),(0,r.kt)("h2",{id:"step1-create-enviroment-and-set-up-the-enviroment"},"step1 Create Enviroment and set up the Enviroment"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Name: highcpu\n\nLocation: us-central1\n\nZone: us-central1-a\n\nMachine type: n1-highcpu-4\n\nPython version 3\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"png",src:a(47597).Z,width:"906",height:"210"}),"\n",(0,r.kt)("img",{alt:"png",src:a(18809).Z,width:"1355",height:"421"}),"\n",(0,r.kt)("img",{alt:"png",src:a(66622).Z,width:"1356",height:"393"})),(0,r.kt)("h2",{id:"step2-\u521b\u5efagcs-bucket"},"step2 \u521b\u5efaGCS bucket"),(0,r.kt)("p",null,"\u8981\u8bb0\u4f4fbucket\u540d\u5b57, \u56e0\u4e3a\u8fd9\u4e2a\u662f\u653eDAG file\u7684"),(0,r.kt)("h2",{id:"step3-\u4e86\u89e3\u6838\u5fc3\u6982\u5ff5"},"step3 \u4e86\u89e3\u6838\u5fc3\u6982\u5ff5"),(0,r.kt)("p",null,"Airflow\u662f\u4e00\u4e2a\u4ee5\u7f16\u7a0b\u65b9\u5f0f\u7f16\u5199\uff0c\u5b89\u6392\u548c\u76d1\u89c6\u5de5\u4f5c\u6d41\u7684\u5e73\u53f0\u3002\n\u4f7f\u7528Airflow\u5c06\u5de5\u4f5c\u6d41\u7f16\u5199\u4e3a\u4efb\u52a1\u7684\u6709\u5411\u65e0\u73af\u56fe\uff08DAG\uff09, \u5c31\u662f\u5355\u5411\u7684"),(0,r.kt)("p",null,"DAG: \u6709\u5411\u65e0\u73af\u56fe\u662f\u60a8\u8981\u8fd0\u884c\u7684\u6240\u6709\u4efb\u52a1\u7684\u96c6\u5408\uff0c\u4ee5\u53cd\u6620\u5176\u5173\u7cfb\u548c\u4f9d\u8d56\u6027\u7684\u65b9\u5f0f\u8fdb\u884c\u7ec4\u7ec7\u3002"),(0,r.kt)("p",null,"Operator: \u5c31\u662f\u5bf9\u5355\u4e00\u4efb\u52a1\u7684\u63cf\u8ff0"),(0,r.kt)("p",null,"Task: \u64cd\u4f5c\u5458\u7684\u53c2\u6570\u5316\u5b9e\u4f8b\uff1bDAG\u4e2d\u7684\u4e00\u4e2a\u8282\u70b9"),(0,r.kt)("p",null,"Task Instance: \u4efb\u52a1\u7684\u7279\u5b9a\u8fd0\u884c\uff1b\u5176\u7279\u5f81\u662f\uff1aDAG\uff0c\u4efb\u52a1\u548c\u65f6\u95f4\u70b9\u3002\u5b83\u5177\u6709\u6307\u793a\u6027\u72b6\u6001\uff1a\u8fd0\u884c\uff0c\u6210\u529f\uff0c\u5931\u8d25\uff0c\u8df3\u8fc7"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://airflow.apache.org/docs/stable/concepts.html#"},"\u66f4\u591a\u6982\u5ff5\u53ef\u4ee5\u67e5\u770b\u94fe\u63a5")),(0,r.kt)("h2",{id:"step4-\u8bbe\u5b9a\u4e00\u4e2aworkflow-\u5de5\u4f5c\u6d41"},"step4: \u8bbe\u5b9a\u4e00\u4e2aworkflow \u5de5\u4f5c\u6d41"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Composer workflows\u662f\u7531DAGs\u7ec4\u6210\u7684. DAGs \u5c31\u662f\u88ab\u5b9a\u4e49\u597d\u7684\u6807\u51c6python\u6587\u4ef6, \u8fd9\u4e9b\u6587\u4ef6\u90fd\u662f\u653e\u5728Airflow\u7684DAG_FOLDER\u4e2d."),(0,r.kt)("li",{parentName:"ol"},"Airflow\u4f1a\u52a8\u6001\u5730\u6267\u884cpython\u6587\u4ef6\u7684\u4ee3\u7801\u6765\u6784\u5efaDAGs\u5bf9\u8c61"),(0,r.kt)("li",{parentName:"ol"},"\u60a8\u53ef\u4ee5\u6839\u636e\u9700\u8981\u62e5\u6709\u4efb\u610f\u6570\u91cf\u7684DAG\uff0c\u6bcf\u4e2aDAG\u63cf\u8ff0\u4efb\u610f\u6570\u91cf\u7684\u4efb\u52a1\u3002\u901a\u5e38\uff0c\u6bcf\u4e2aDAG\u5e94\u5bf9\u5e94\u4e00\u4e2a\u903b\u8f91\u5de5\u4f5c\u6d41\u7a0bworkflow\u3002")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"\"\"\"Example Airflow DAG that creates a Cloud Dataproc cluster, runs the Hadoop\nwordcount example, and deletes the cluster.\nThis DAG relies on three Airflow variables\nhttps://airflow.apache.org/concepts.html#variables\n\u8fd9\u91cc\u662f\u5728airflow web interface\u7684admin>>varibale\u8bbe\u7f6e\u7684\n* gcp_project - Google Cloud Project to use for the Cloud Dataproc cluster.\n* gce_zone - Google Compute Engine zone where Cloud Dataproc cluster should be\n  created.\n* gcs_bucket - Google Cloud Storage bucket to use for result of Hadoop job.\n  See https://cloud.google.com/storage/docs/creating-buckets for creating a\n  bucket.\n\"\"\"\n\nimport datetime\nimport os\n\nfrom airflow import models\nfrom airflow.contrib.operators import dataproc_operator\nfrom airflow.utils import trigger_rule\n\n# Output file for Cloud Dataproc job. \u8f93\u51fa\u6587\u4ef6\u5730\u5740\n# \u8f93\u51fa\u7684\u5730\u5740\u662f\u901a\u8fc7gcs+\u6587\u4ef6\u540d\u5b57(wordcount) + \u65f6\u95f4 + '/'\noutput_file = os.path.join(\n    models.Variable.get('gcs_bucket'), 'wordcount',\n    datetime.datetime.now().strftime('%Y%m%d-%H%M%S')) + os.sep\n# Path to Hadoop wordcount example available on every Dataproc cluster.\nWORDCOUNT_JAR = (\n    'file:///usr/lib/hadoop-mapreduce/hadoop-mapreduce-examples.jar'\n)\n# Arguments to pass to Cloud Dataproc job.\nwordcount_args = ['wordcount', 'gs://pub/shakespeare/rose.txt', output_file]\n\nyesterday = datetime.datetime.combine(\n    datetime.datetime.today() - datetime.timedelta(1),\n    datetime.datetime.min.time())\n\ndefault_dag_args = {\n    # Setting start date as yesterday starts the DAG immediately when it is\n    # detected in the Cloud Storage bucket.\n    'start_date': yesterday,\n    # To email on failure or retry set 'email' arg to your email and enable\n    # emailing here.\n    'email_on_failure': False,\n    'email_on_retry': False,\n    # If a task fails, retry it once after waiting at least 5 minutes\n    'retries': 1,\n    'retry_delay': datetime.timedelta(minutes=5),\n    'project_id': models.Variable.get('gcp_project')\n}\n\n# [START composer_hadoop_schedule]\nwith models.DAG(\n        'composer_hadoop_tutorial',\n        # Continue to run DAG once per day\n        schedule_interval=datetime.timedelta(days=1),\n        default_args=default_dag_args) as dag:\n    # [END composer_hadoop_schedule]\n\n    # Create a Cloud Dataproc cluster.\n    create_dataproc_cluster = dataproc_operator.DataprocClusterCreateOperator(\n        task_id='create_dataproc_cluster',\n        # Give the cluster a unique name by appending the date scheduled.\n        # See https://airflow.apache.org/code.html#default-variables\n        cluster_name='composer-hadoop-tutorial-cluster-{{ ds_nodash }}',\n        num_workers=2,\n        zone=models.Variable.get('gce_zone'),\n        master_machine_type='n1-standard-1',\n        worker_machine_type='n1-standard-1')\n\n    # Run the Hadoop wordcount example installed on the Cloud Dataproc cluster\n    # master node.\n    run_dataproc_hadoop = dataproc_operator.DataProcHadoopOperator(\n        task_id='run_dataproc_hadoop',\n        main_jar=WORDCOUNT_JAR,\n        cluster_name='composer-hadoop-tutorial-cluster-{{ ds_nodash }}',\n        arguments=wordcount_args)\n\n    # Delete Cloud Dataproc cluster.\n    delete_dataproc_cluster = dataproc_operator.DataprocClusterDeleteOperator(\n        task_id='delete_dataproc_cluster',\n        cluster_name='composer-hadoop-tutorial-cluster-{{ ds_nodash }}',\n        # Setting trigger_rule to ALL_DONE causes the cluster to be deleted\n        # even if the Dataproc job fails.\n        trigger_rule=trigger_rule.TriggerRule.ALL_DONE)\n\n    # [START composer_hadoop_steps]\n    # Define DAG dependencies.\n    create_dataproc_cluster >> run_dataproc_hadoop >> delete_dataproc_cluster\n    # [END composer_hadoop_steps]\n")),(0,r.kt)("h2",{id:"\u4e3a\u4e86\u534f\u8c03\u8fd9\u4e09\u4e2a\u5de5\u4f5c\u6d41\u7a0b\u4efb\u52a1dag\u5bfc\u5165\u4e86\u4ee5\u4e0b\u8fd0\u7b97\u7b26"},"\u4e3a\u4e86\u534f\u8c03\u8fd9\u4e09\u4e2a\u5de5\u4f5c\u6d41\u7a0b\u4efb\u52a1\uff0cDAG\u5bfc\u5165\u4e86\u4ee5\u4e0b\u8fd0\u7b97\u7b26\uff1a"),(0,r.kt)("p",null,"DataprocClusterCreateOperator\uff1a\u521b\u5efa\u4e00\u4e2aCloud Dataproc\u96c6\u7fa4\u3002\nDataProcHadoopOperator\uff1a\u63d0\u4ea4Hadoop wordcount\u4f5c\u4e1a\u5e76\u5c06\u7ed3\u679c\u5199\u5165Cloud Storage\u5b58\u50a8\u6876\u3002\nDataprocClusterDeleteOperator\uff1a\u5220\u9664\u7fa4\u96c6\u4ee5\u907f\u514d\u4ea7\u751f\u6301\u7eed\u7684Compute Engine\u8d39\u7528\u3002"),(0,r.kt)("p",null,"\u4efb\u52a1\u6309\u987a\u5e8f\u8fd0\u884c\uff0c\u60a8\u53ef\u4ee5\u5728\u6587\u4ef6\u7684\u6b64\u90e8\u5206\u4e2d\u770b\u5230"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"# Define DAG dependencies.\ncreate_dataproc_cluster >> run_dataproc_hadoop >> delete_dataproc_cluster\n")),(0,r.kt)("p",null,"DAG\u7684\u540d\u79f0\u4e3ahadoop_tutorial\uff0c\u5e76\u4e14DAG\u6bcf\u5929\u8fd0\u884c\u4e00\u6b21\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"with models.DAG(\n        'composer_hadoop_tutorial',\n        # Continue to run DAG once per day\n        schedule_interval=datetime.timedelta(days=1),\n        default_args=default_dag_args) as dag:\n")),(0,r.kt)("p",null,"\u7531\u4e8estart_date\u4f20\u9012\u7ed9default_dag_args\u7684\u8bbe\u7f6e\u4e3ayesterday\uff0c\u56e0\u6b64Cloud Composer\u5b89\u6392\u5de5\u4f5c\u6d41\u5728DAG\u4e0a\u4f20\u540e\u7acb\u5373\u5f00\u59cb\u3002"),(0,r.kt)("h2",{id:"step5-\u8bbe\u7f6eairflow\u53d8\u91cf"},"step5 \u8bbe\u7f6eairflow\u53d8\u91cf"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u53bbairflow web interface ")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"png",src:a(29155).Z,width:"904",height:"361"})),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"\u521b\u5efa\u4ee5\u4e0bAireflow\u53d8\u91cfgcp_project\uff0cgcs_bucket\u4ee5\u53cagce_zone\uff1a\n",(0,r.kt)("img",{alt:"png",src:a(5769).Z,width:"1447",height:"468"}))),(0,r.kt)("h2",{id:"step6-\u5c06dag\u4e0a\u8f7d\u5230\u4e91\u5b58\u50a8"},"step6 \u5c06DAG\u4e0a\u8f7d\u5230\u4e91\u5b58\u50a8"),(0,r.kt)("p",null,"\u5728Cloud Shell\u4e2d\uff0c\u5c06hadoop_tutorial.py\u590d\u5236\u5e76\u4fdd\u5b58\u5728\u672c\u5730\u865a\u62df\u673a\u4e0a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"git clone https://github.com/GoogleCloudPlatform/python-docs-samples\n")),(0,r.kt)("p",null,"\u8f6c\u5230python-docs-samples\u76ee\u5f55\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cd python-docs-samples/composer/workflows\n")),(0,r.kt)("p",null,"\u73b0\u5728\uff0c\u5c06hadoop_tutorial.py\u6587\u4ef6\u7684\u526f\u672c\u4e0a\u8f7d\u5230Cloud Storage\u5b58\u50a8\u6876\uff0c\u8be5\u5b58\u50a8\u6876\u5728\u521b\u5efa\u73af\u5883\u65f6\u4f1a\u81ea\u52a8\u521b\u5efa\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u8f6c\u5230Composer > \u73af\u5883\u8fdb\u884c\u68c0\u67e5\u3002\u5355\u51fb\u60a8\u5148\u524d\u521b\u5efa\u7684\u73af\u5883\uff0c\u8fd9\u5c06\u5e26\u60a8\u8fdb\u5165\u6240\u521b\u5efa\u73af\u5883\u7684\u63cf\u8ff0\u3002\u67e5\u627eDAGs folder\uff0c\u590d\u5236\u8981\u66ff\u6362\u7684\u503c\uff0cDAGs_folder_path\u5e76\u5728\u4ee5\u4e0b\u547d\u4ee4\u4e2d\u4e0a\u4f20\u6587\u4ef6\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"gsutil cp hadoop_tutorial.py DAGs_folder_path\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"png",src:a(72264).Z,width:"1434",height:"130"})),(0,r.kt)("p",null,"\u63a2\u7d22DAG\u8fd0\u884c\n\u5f53\u60a8\u5c06DAG\u6587\u4ef6\u4e0a\u4f20\u5230dagsCloud Storage\u4e2d\u7684\u6587\u4ef6\u5939\u65f6\uff0cCloud Composer\u4f1a\u89e3\u6790\u8be5\u6587\u4ef6\u3002\u5982\u679c\u672a\u627e\u5230\u9519\u8bef\uff0c\u5219\u5de5\u4f5c\u6d41\u7684\u540d\u79f0\u5c06\u663e\u793a\u5728DAG\u5217\u8868\u4e2d\uff0c\u5e76\u4e14\u8be5\u5de5\u4f5c\u6d41\u5df2\u6392\u961f\u7b49\u5f85\u7acb\u5373\u8fd0\u884c\u3002"),(0,r.kt)("p",null,"\u786e\u4fdd\u60a8\u5728Airflow Web\u754c\u9762\u7684DAG\u9009\u9879\u5361\u4e0a\u3002\u6b64\u8fc7\u7a0b\u9700\u8981\u51e0\u5206\u949f\u624d\u80fd\u5b8c\u6210\u3002\u5237\u65b0\u6d4f\u89c8\u5668\u4ee5\u786e\u4fdd\u60a8\u6b63\u5728\u67e5\u770b\u6700\u65b0\u4fe1\u606f\u3002\n",(0,r.kt)("img",{alt:"png",src:a(39216).Z,width:"1515",height:"653"}),"\n",(0,r.kt)("img",{alt:"png",src:a(56936).Z,width:"1522",height:"677"}),"\n",(0,r.kt)("img",{alt:"png",src:a(6692).Z,width:"1500",height:"693"})),(0,r.kt)("h2",{id:"step7-\u91cd\u65b0\u8fd0\u884c\u5de5\u4f5c\u6d41\u7a0b"},"step7 \u91cd\u65b0\u8fd0\u884c\u5de5\u4f5c\u6d41\u7a0b"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5355\u51fbcreate_dataproc_cluster\u56fe\u5f62\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u5355\u51fb\u6e05\u9664\u4ee5\u91cd\u7f6e\u4e09\u4e2a\u4efb\u52a1\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u7136\u540e\u5355\u51fb\u786e\u5b9a\u8fdb\u884c\u786e\u8ba4\u3002\u8bf7\u6ce8\u610f\uff0ccreate_dataproc_cluster\u5468\u56f4\u7684\u989c\u8272\u5df2\u66f4\u6539\uff0c\u72b6\u6001\u4e3a\u201c\u6b63\u5728\u8fd0\u884c\u201d\u3002\n",(0,r.kt)("img",{alt:"png",src:a(39329).Z,width:"1760",height:"686"}))),(0,r.kt)("p",null,"\u6211\u4eec\u53ef\u4ee5\u770b\u5230dataproc\u5177\u4f53\u7684\u8fd0\u884c\u60c5\u51b5\n",(0,r.kt)("img",{alt:"png",src:a(85929).Z,width:"1272",height:"466"}),"\n",(0,r.kt)("img",{alt:"png",src:a(89139).Z,width:"1455",height:"387"}),"\n",(0,r.kt)("img",{alt:"png",src:a(75220).Z,width:"920",height:"933"})),(0,r.kt)("p",null,"job\u5b8c\u6210\u540e,GSC\u7684\u60c5\u51b5\n",(0,r.kt)("img",{alt:"png",src:a(57400).Z,width:"1677",height:"470"}),"\n",(0,r.kt)("img",{alt:"png",src:a(61121).Z,width:"1111",height:"574"}),"\n",(0,r.kt)("img",{alt:"png",src:a(76858).Z,width:"718",height:"188"})))}d.isMDXComponent=!0},47597:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/1-1-149d085e217c11f6353902734df52744.png"},29155:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/1-982189e233202b9c999e894ae433a0ff.png"},5769:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/2-895f294b60ea7ec57e0c2a62d250d9ee.png"},72264:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/3-79af8188f8a9caee4012fda84d8ffdf1.png"},39216:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/4-012a742252a1ce95a5bf11ea4a0f8c78.png"},56936:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/5-29c28f30cff4ea1bc97a36866ef1ca96.png"},6692:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/6-8ee15c66f86754e752b2e994e5cee3de.png"},39329:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/7-e08ab972a79b667b43452eb478b85c89.png"},85929:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/d-1-14c5486fac198be75aabef250292078e.png"},89139:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/d-2-1d920d6ccabf6fd51b6d7b92887b72a3.png"},75220:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/d-3-b546b609f41110f8b9745a5be427745c.png"},57400:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/gs-1-3109a2f4058bb96f715e82e0f0856587.png"},61121:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/gs-2-4d1898af5d8043a8ca9358be2bdbc0c3.png"},76858:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/gs-3-9ec8f034caa23d67c5a9994af0c70c21.png"},18809:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/k-1-1df16c2dad1b5b699b15bcbb38da4ffd.png"},66622:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/k-2-65b44c7e075ec0e2b4fabf5bb1542d9b.png"}}]);